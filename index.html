<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Contact G.voida</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #007bff; /* Bleu vibrant */
      --primary-hover-color: #0056b3; /* Bleu plus foncé au survol */
      --text-color: #343a40; /* Gris foncé pour le texte */
      --background-color: #f0f2f5; /* Gris clair doux pour l'arrière-plan */
      --card-background: #ffffff; /* Blanc pur pour les cartes */
      --border-color: #ced4da; /* Gris clair pour les bordures */
      --focus-shadow: rgba(0, 123, 255, 0.25); /* Ombre pour les champs en focus */
      --error-color: #dc3545; /* Rouge pour les erreurs */
      --shadow-light: rgba(0, 0, 0, 0.08); /* Ombre légère pour les éléments */
      --shadow-medium: rgba(0, 0, 0, 0.12); /* Ombre moyenne */
    }

    body {
      font-family: 'Inter', system-ui, sans-serif; /* Nouvelle police de caractères */
      margin: 0; /* Supprime la marge par défaut du body */
      padding: 40px 20px; /* Ajoute un padding pour l'espace */
      background: var(--background-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center; /* Centre le contenu horizontalement */
      min-height: 100vh; /* S'assure que le body prend toute la hauteur de la vue */
      box-sizing: border-box; /* Inclut le padding dans la hauteur/largeur totale */
    }

    h1 {
      color: var(--primary-color);
      margin-bottom: 30px;
      font-weight: 600; /* Plus de gras pour le titre */
      text-align: center;
    }

    form {
      background: var(--card-background);
      padding: 35px; /* Plus de padding pour l'espace intérieur */
      max-width: 550px; /* Augmente légèrement la largeur maximale */
      width: 100%; /* S'assure qu'il prend toute la largeur disponible */
      border-radius: 12px; /* Bords plus arrondis */
      box-shadow: 0 6px 15px var(--shadow-light); /* Ombre plus prononcée mais douce */
      border: 1px solid #e9ecef; /* Bordure légère */
      box-sizing: border-box; /* Important pour le padding */
    }

    label {
      display: block; /* Chaque label sur une nouvelle ligne */
      margin-top: 20px; /* Plus d'espace entre les labels */
      margin-bottom: 8px; /* Espace sous le label */
      font-weight: 600; /* Texte des labels en gras */
      color: var(--text-color);
    }

    input,
    textarea {
      width: calc(100% - 22px); /* Ajuste la largeur avec le padding */
      padding: 12px; /* Plus de padding pour les champs */
      border: 1px solid var(--border-color);
      border-radius: 8px; /* Bords arrondis pour les champs */
      font-size: 1rem; /* Taille de police lisible */
      color: var(--text-color);
      background-color: #f8f9fa; /* Fond légèrement grisé pour les champs */
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out; /* Transition douce */
    }

    input:focus,
    textarea:focus {
      border-color: var(--primary-color); /* Bordure bleue au focus */
      box-shadow: 0 0 0 3px var(--focus-shadow); /* Ombre au focus */
      outline: none; /* Supprime l'outline par défaut du navigateur */
      background-color: var(--card-background); /* Reviens au blanc au focus */
    }

    textarea {
      resize: vertical; /* Permet uniquement le redimensionnement vertical */
      min-height: 100px; /* Hauteur minimale pour le textarea */
    }

    button {
      margin-top: 30px; /* Plus d'espace au-dessus du bouton */
      padding: 14px 28px; /* Plus de padding pour le bouton */
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 8px; /* Bords arrondis */
      cursor: pointer;
      font-size: 1.1rem; /* Taille de police plus grande */
      font-weight: 600; /* Gras pour le bouton */
      transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
      width: 100%; /* Bouton pleine largeur */
    }

    button:hover:not(:disabled) {
      background: var(--primary-hover-color);
      transform: translateY(-2px); /* Léger effet de soulèvement au survol */
      box-shadow: 0 4px 10px var(--shadow-light); /* Ombre au survol */
    }

    button:active:not(:disabled) {
      transform: translateY(0); /* Effet de clic */
      box-shadow: none;
    }

    button:disabled {
      background: #adb5bd; /* Gris plus clair pour désactivé */
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    p.alert {
      color: var(--error-color);
      font-weight: 600;
      margin-top: 25px; /* Plus d'espace */
      text-align: center;
      font-size: 1.05rem;
      padding: 15px;
      border: 1px solid var(--error-color);
      background-color: rgba(220, 53, 69, 0.08); /* Fond léger pour l'alerte */
      border-radius: 8px;
      max-width: 550px;
      width: 100%;
      box-sizing: border-box;
    }

    p.alert a {
      color: var(--error-color); /* Lien dans la même couleur que l'alerte */
      text-decoration: underline;
      font-weight: 700;
    }

    p.alert a:hover {
      color: #a71d2a; /* Rouge plus foncé au survol */
    }

    .error-message {
      color: var(--error-color);
      font-weight: 600;
      margin-top: 15px;
      font-size: 0.95rem;
      text-align: center;
      display: none; /* Toujours caché par défaut, JavaScript le rend visible */
    }
  </style>
</head>
<body>

<h1>Contacter G.voida</h1>

<form id="contact-form">
  <label for="name">Nom</label>
  <input type="text" name="name" id="name" required />

  <label for="email">Email</label>
  <input type="email" name="email" id="email" required />

  <label for="message">Message</label>
  <textarea name="message" id="message" rows="5" required></textarea>
  <p class="error-message" id="filter-error-message"></p>

  <button type="submit" id="submit-btn">Envoyer</button>
</form>

<p class="alert" id="alert-msg">
  ⚠️ Le formulaire est actuellement désactivé. Vous pouvez faire la requête sur mon serveur Discord :
  <a href="https://discord.gg/ye8MhVUdWU" target="_blank" rel="noopener noreferrer">https://discord.gg/ye8MhVUdWU</a>
</p>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
  // -------------------------
  // CHANGE CETTE VARIABLE ICI
  // true = formulaire désactivé
  // false = formulaire actif
  const formDisabled = false; // Mettez à 'true' pour désactiver le formulaire complètement
  // -------------------------

  const form = document.getElementById('contact-form');
  const inputs = form.querySelectorAll('input, textarea, button');
  const alertMsg = document.getElementById('alert-msg');
  const filterErrorMessage = document.getElementById('filter-error-message');
  const submitBtn = document.getElementById('submit-btn');

  // Initialisation EmailJS (remplace par ta clé publique)
  // Assurez-vous que "4EhJw2YMfXrhsNEKn" est bien votre PUBLIC_KEY EmailJS
  emailjs.init("4EhJw2YMfXrhsNEKn");

  // --- PARAMÈTRES DE FILTRAGE ET DE "BANNISSEMENT" ---

  // Liste noire de mots et expressions (en minuscules pour une meilleure comparaison)
  // Ajoutez ici tous les mots ou expressions que vous souhaitez bloquer.
  // Par exemple : "arnaque", "vente", "promo", "argent facile", etc.
  const BLACKLIST_WORDS = [
    "viagra",
    "casino",
    "publicite",
    "offre speciale",
    "sex",
    "arnaque",
    "bitcoin",
    "gagner de l'argent",
    "credit rapide",
    "gratuitement maintenant",
    "appelle moi",
    // Ajoutez vos propres mots ou expressions :
    // "exemplemotinterdit",
    // "autremotbloqué",
  ];

  const MAX_ATTEMPTS = 3; // Nombre maximum de tentatives échouées avant "ban"
  const BAN_DURATION_MS = 3600000; // Durée du "ban" en millisecondes (ici 1 heure = 3600 * 1000)
  const LS_KEY_ATTEMPTS = 'contactFormAttempts';
  const LS_KEY_BAN_TIME = 'contactFormBanTime';

  // --- FONCTIONS DE FILTRAGE ET DE BANNISSEMENT ---

  /**
   * Vérifie si le message contient un mot de la liste noire.
   * @param {string} message Le contenu du message à vérifier.
   * @returns {string|boolean} Le mot détecté ou false si aucun mot n'est trouvé.
   */
  function containsBlacklistedWord(message) {
    const lowerCaseMessage = message.toLowerCase(); // Convertit le message en minuscules
    for (const word of BLACKLIST_WORDS) {
      // Crée une expression régulière pour trouver le mot entier (avec \b pour "word boundary")
      // Par exemple, "con" ne bloquera pas "content", mais bien "con" seul.
      const regex = new RegExp(`\\b${word}\\b`, 'g');
      if (regex.test(lowerCaseMessage)) {
        return word; // Retourne le mot interdit trouvé
      }
    }
    return false; // Aucun mot de la liste noire n'a été trouvé
  }

  /**
   * Vérifie si l'utilisateur est actuellement "banni".
   * Si oui, désactive le formulaire et affiche un message.
   * @returns {boolean} True si l'utilisateur est banni, false sinon.
   */
  function checkIfBanned() {
    const banTime = localStorage.getItem(LS_KEY_BAN_TIME);
    if (banTime && (Date.now() < parseInt(banTime) + BAN_DURATION_MS)) {
      const remainingTime = Math.ceil((parseInt(banTime) + BAN_DURATION_MS - Date.now()) / 60000); // Minutes restantes
      filterErrorMessage.textContent = `Vous avez effectué trop de tentatives non valides. Veuillez réessayer dans ${remainingTime} minutes.`;
      filterErrorMessage.style.display = 'block';
      inputs.forEach(el => el.disabled = true); // Désactive tous les champs du formulaire
      submitBtn.disabled = true; // Désactive spécifiquement le bouton d'envoi
      return true;
    }
    // Si l'utilisateur n'est plus banni ou si le temps est écoulé, on nettoie le localStorage
    if (banTime && (Date.now() >= parseInt(banTime) + BAN_DURATION_MS)) {
        resetFailedAttempts(); // Réinitialise les compteurs si le ban est terminé
    }
    return false;
  }

  /**
   * Incrémente le compteur de tentatives échouées.
   * Si le nombre max de tentatives est atteint, déclenche le "bannissement".
   */
  function incrementFailedAttempts() {
    let attempts = parseInt(localStorage.getItem(LS_KEY_ATTEMPTS) || '0');
    attempts++;
    localStorage.setItem(LS_KEY_ATTEMPTS, attempts);
    if (attempts >= MAX_ATTEMPTS) {
      localStorage.setItem(LS_KEY_BAN_TIME, Date.now().toString()); // Enregistre l'heure du ban
      localStorage.removeItem(LS_KEY_ATTEMPTS); // Réinitialise les tentatives après un ban
      checkIfBanned(); // Active le mode "banni" immédiatement
    }
  }

  /**
   * Réinitialise le compteur de tentatives et l'état de "bannissement".
   * Appelé après un envoi réussi ou si le temps de ban est écoulé.
   */
  function resetFailedAttempts() {
    localStorage.removeItem(LS_KEY_ATTEMPTS);
    localStorage.removeItem(LS_KEY_BAN_TIME);
    filterErrorMessage.style.display = 'none'; // Cache le message d'erreur
    inputs.forEach(el => el.disabled = false); // Réactive tous les champs
    submitBtn.disabled = false; // Réactive le bouton d'envoi
  }

  // --- LOGIQUE PRINCIPALE DU FORMULAIRE ---
  if (formDisabled) {
    // Si la variable formDisabled est à 'true', désactiver le formulaire et afficher l'alerte Discord
    inputs.forEach(el => el.disabled = true);
    alertMsg.style.display = 'block';
  } else {
    // Si le formulaire est actif, masquer l'alerte initiale
    alertMsg.style.display = 'none';

    // Vérifie si l'utilisateur est banni au chargement de la page
    checkIfBanned();

    form.addEventListener('submit', function(e) {
      e.preventDefault(); // Empêche l'envoi par défaut du formulaire HTML

      filterErrorMessage.style.display = 'none'; // Masque tout message d'erreur précédent

      // Si le bouton est déjà désactivé (par un ban ou envoi en cours), ne rien faire
      if (submitBtn.disabled) {
          return;
      }

      const messageContent = document.getElementById('message').value;
      const detectedBlacklistedWord = containsBlacklistedWord(messageContent);

      if (detectedBlacklistedWord) {
        // Si un mot de la liste noire est trouvé
        filterErrorMessage.textContent = `Votre message contient un terme non autorisé ("${detectedBlacklistedWord}"). Veuillez le modifier.`;
        filterErrorMessage.style.display = 'block';
        incrementFailedAttempts(); // Incrémente les tentatives (compte comme une tentative non valide)
        checkIfBanned(); // Vérifie si cette tentative déclenche un bannissement
        return; // Arrête l'envoi du formulaire
      }

      // Si le message est valide (pas de mot blacklisté), procède à l'envoi via EmailJS
      submitBtn.disabled = true; // Désactive le bouton pour éviter les envois multiples
      submitBtn.textContent = 'Envoi en cours...'; // Met à jour le texte du bouton

      emailjs.sendForm("service_e52327e", "template_r8rm75g", this)
        .then(() => {
          // Succès de l'envoi
          alert('✅ Message envoyé à G.voida !');
          form.reset(); // Réinitialise les champs du formulaire
          resetFailedAttempts(); // Réinitialise les tentatives après un envoi réussi
        })
        .catch((error) => {
          // Échec de l'envoi
          console.error("Erreur EmailJS:", error); // Affiche l'erreur dans la console pour le débogage
          alert('❌ Erreur lors de l\'envoi. Veuillez réessayer.');
          incrementFailedAttempts(); // Incrémente les tentatives en cas d'erreur d'envoi
          checkIfBanned(); // Vérifie si on doit bannir suite à cette erreur
        })
        .finally(() => {
          // Cette partie s'exécute après .then ou .catch
          // Si l'utilisateur n'est pas banni par l'échec, réactive le bouton
          if (!checkIfBanned()) { // Vérifie à nouveau l'état du bannissement
            submitBtn.disabled = false;
            submitBtn.textContent = 'Envoyer';
          }
        });
    });
  }
</script>

</body>
</html>
